{
  "version": 3,
  "sources": ["../../@arcgis/core/symbols/support/previewCIMSymbol.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{px2pt as e,pt2px as t}from\"../../core/screenUtils.js\";import{OverrideHelper as i,CIMSymbolHelper as l}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as r,GeometryStyle as n}from\"../cim/CIMSymbolRasterizer.js\";import{mapCIMSymbolToGeometryType as o}from\"../cim/utils.js\";import{SymbolSizeDefaults as a}from\"./previewUtils.js\";import{renderSymbol as s}from\"./renderUtils.js\";const c=new r(null,!0),h=e(a.size),m=e(a.maxSize),u=e(a.lineWidth),f=1;function y(e){const t=e?.size;if(\"number\"==typeof t)return{width:t,height:t};return{width:null!=t&&\"object\"==typeof t&&\"width\"in t?t.width:null,height:null!=t&&\"object\"==typeof t&&\"height\"in t?t.height:null}}async function d(e,r={}){const{node:a,opacity:d,symbolConfig:g}=r,p=null!=g&&\"object\"==typeof g&&\"isSquareFill\"in g&&g.isSquareFill,w=r.cimOptions||r,b=w.geometryType||o(e?.data?.symbol),M=y(r),{feature:j,fieldMap:v}=w;if(null==M.width||null==M.height){const t=await i.resolveSymbolOverrides(e.data,j,null,v,b);if(!t)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:t},e.data.primitiveOverrides=void 0;const r=[];l.fetchResources(t,c.resourceManager,r),l.fetchFonts(t,c.resourceManager,r),r.length>0&&await Promise.all(r);const n=l.getEnvelope(t,null,c.resourceManager),o=n?.width,a=n?.height;M.width=\"esriGeometryPolygon\"===b?h:\"esriGeometryPolyline\"===b?u:null!=o&&isFinite(o)?Math.min(o,m):h,M.height=\"esriGeometryPolygon\"===b?h:null!=a&&isFinite(a)?Math.max(Math.min(a,m),f):h}const S=await c.rasterizeCIMSymbolAsync(e,j,M,p||\"esriGeometryPolygon\"!==b?n.Preview:n.Legend,v,b);if(!S)return null;const{width:C,height:L}=S,I=document.createElement(\"canvas\");I.width=C,I.height=L;I.getContext(\"2d\").putImageData(S,0,0);const P=t(M.width),x=t(M.height),z=new Image(P,x);z.src=I.toDataURL(),z.ariaLabel=r.ariaLabel??null,z.alt=r.ariaLabel??\"\",null!=d&&(z.style.opacity=`${d}`);let F=z;if(null!=r.effectView){const e={shape:{type:\"image\",x:0,y:0,width:P,height:x,src:z.src},fill:null,stroke:null,offset:[0,0]};F=s([[e]],[P,x],{effectView:r.effectView,ariaLabel:r.ariaLabel})}return a&&F&&a.appendChild(F),F}export{d as previewCIMSymbol};\n"],
  "mappings": "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",
  "names": ["u", "e", "t", "d", "M", "r", "a", "z"]
}
