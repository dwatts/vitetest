{
  "version": 3,
  "sources": ["../../@arcgis/core/views/webgl/VertexArrayObject.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Logger.js\";import{disposeMaybe as e,nullifyNonNullableForDispose as i}from\"../../core/maybe.js\";import{typedArrayStaticSize as r}from\"../../core/typedArrayUtil.js\";import{ResourceType as s}from\"./enums.js\";import{bindVertexBufferLayout as n,unbindVertexBufferLayout as o}from\"./Util.js\";const f=t.getLogger(\"esri.views.webgl.VertexArrayObject\");let u=class{constructor(t,e,i,r,n=null){this._context=t,this._locations=e,this._layout=i,this._buffers=r,this._indexBuffer=n,this._glName=null,this._initialized=!1,t.instanceCounter.increment(s.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Object.keys(this._buffers).reduce(((t,e)=>t+this._buffers[e].byteLength),null!=this._indexBuffer?this._indexBuffer.byteLength:0)}get layout(){return this._layout}get locations(){return this._locations}get memoryEstimate(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*r}dispose(){if(this._context){this._context.getBoundVAO()===this&&this._context.bindVAO(null);for(const t in this._buffers)this._buffers[t]?.dispose(),delete this._buffers[t];this._indexBuffer=e(this._indexBuffer),this.disposeVAOOnly()}else(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&f.warn(\"Leaked WebGL VAO\")}disposeVAOOnly(){if(this._glName){const t=this._context?.capabilities?.vao;t.deleteVertexArray(this._glName),this._glName=null}this._context.instanceCounter.decrement(s.VertexArrayObject,this),this._context=i(this._context)}initialize(){if(this._initialized)return;const t=this._context.capabilities.vao;if(t){const e=t.createVertexArray();t.bindVertexArray(e),this._bindLayout(),t.bindVertexArray(null),this._glName=e}this._initialized=!0}bind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:t,_layout:e,_indexBuffer:i}=this;t||f.error(\"Vertex buffer dictionary is empty!\");const r=this._context.gl;for(const s in t){const i=t[s];i||f.error(\"Vertex buffer is uninitialized!\");const r=e[s];r||f.error(\"Vertex element descriptor is empty!\"),n(this._context,this._locations,i,r)}if(null!=i){!!this._context.capabilities.vao?r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i)}}unbind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:t,_layout:e}=this;t||f.error(\"Vertex buffer dictionary is empty!\");for(const i in t){const r=t[i];r||f.error(\"Vertex buffer is uninitialized!\");const s=e[i];o(this._context,this._locations,r,s)}null!=this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)}};export{u as VertexArrayObject};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAIwT,IAAM,IAAE,EAAE,UAAU,oCAAoC;AAAE,IAAI,IAAE,MAAK;AAAA,EAAC,YAAYA,IAAE,GAAEC,IAAE,GAAE,IAAE,MAAK;AAAC,SAAK,WAASD,IAAE,KAAK,aAAW,GAAE,KAAK,UAAQC,IAAE,KAAK,WAAS,GAAE,KAAK,eAAa,GAAE,KAAK,UAAQ,MAAK,KAAK,eAAa,OAAGD,GAAE,gBAAgB,UAAU,EAAE,mBAAkB,IAAI;AAAA,EAAC;AAAA,EAAC,IAAI,SAAQ;AAAC,WAAO,KAAK;AAAA,EAAO;AAAA,EAAC,IAAI,UAAS;AAAC,WAAO,KAAK;AAAA,EAAQ;AAAA,EAAC,IAAI,gBAAe;AAAC,WAAO,KAAK;AAAA,EAAQ;AAAA,EAAC,IAAI,cAAa;AAAC,WAAO,KAAK;AAAA,EAAY;AAAA,EAAC,IAAI,WAAU;AAAC,WAAO,OAAO,KAAK,KAAK,QAAQ,EAAE,OAAQ,CAACA,IAAE,MAAIA,KAAE,KAAK,SAAS,CAAC,EAAE,YAAY,QAAM,KAAK,eAAa,KAAK,aAAa,aAAW,CAAC;AAAA,EAAC;AAAA,EAAC,IAAI,SAAQ;AAAC,WAAO,KAAK;AAAA,EAAO;AAAA,EAAC,IAAI,YAAW;AAAC,WAAO,KAAK;AAAA,EAAU;AAAA,EAAC,IAAI,iBAAgB;AAAC,WAAO,KAAK,YAAU,OAAO,KAAK,KAAK,QAAQ,EAAE,UAAQ,KAAK,eAAa,IAAE,MAAI;AAAA,EAAC;AAAA,EAAC,UAAS;AAJpjC;AAIqjC,QAAG,KAAK,UAAS;AAAC,WAAK,SAAS,YAAY,MAAI,QAAM,KAAK,SAAS,QAAQ,IAAI;AAAE,iBAAUA,MAAK,KAAK;AAAS,mBAAK,SAASA,EAAC,MAAf,mBAAkB,WAAU,OAAO,KAAK,SAASA,EAAC;AAAE,WAAK,eAAa,EAAE,KAAK,YAAY,GAAE,KAAK,eAAe;AAAA,IAAC;AAAK,OAAC,KAAK,WAAS,OAAO,oBAAoB,KAAK,QAAQ,EAAE,SAAO,MAAI,EAAE,KAAK,kBAAkB;AAAA,EAAC;AAAA,EAAC,iBAAgB;AAJx4C;AAIy4C,QAAG,KAAK,SAAQ;AAAC,YAAMA,MAAE,gBAAK,aAAL,mBAAe,iBAAf,mBAA6B;AAAI,MAAAA,GAAE,kBAAkB,KAAK,OAAO,GAAE,KAAK,UAAQ;AAAA,IAAI;AAAC,SAAK,SAAS,gBAAgB,UAAU,EAAE,mBAAkB,IAAI,GAAE,KAAK,WAAS,EAAE,KAAK,QAAQ;AAAA,EAAC;AAAA,EAAC,aAAY;AAAC,QAAG,KAAK;AAAa;AAAO,UAAMA,KAAE,KAAK,SAAS,aAAa;AAAI,QAAGA,IAAE;AAAC,YAAM,IAAEA,GAAE,kBAAkB;AAAE,MAAAA,GAAE,gBAAgB,CAAC,GAAE,KAAK,YAAY,GAAEA,GAAE,gBAAgB,IAAI,GAAE,KAAK,UAAQ;AAAA,IAAC;AAAC,SAAK,eAAa;AAAA,EAAE;AAAA,EAAC,OAAM;AAAC,SAAK,WAAW;AAAE,UAAMA,KAAE,KAAK,SAAS,aAAa;AAAI,IAAAA,KAAEA,GAAE,gBAAgB,KAAK,MAAM,KAAG,KAAK,SAAS,QAAQ,IAAI,GAAE,KAAK,YAAY;AAAA,EAAE;AAAA,EAAC,cAAa;AAAC,UAAK,EAAC,UAASA,IAAE,SAAQ,GAAE,cAAaC,GAAC,IAAE;AAAK,IAAAD,MAAG,EAAE,MAAM,oCAAoC;AAAE,UAAM,IAAE,KAAK,SAAS;AAAG,eAAUE,MAAKF,IAAE;AAAC,YAAMC,KAAED,GAAEE,EAAC;AAAE,MAAAD,MAAG,EAAE,MAAM,iCAAiC;AAAE,YAAME,KAAE,EAAED,EAAC;AAAE,MAAAC,MAAG,EAAE,MAAM,qCAAqC,GAAE,EAAE,KAAK,UAAS,KAAK,YAAWF,IAAEE,EAAC;AAAA,IAAC;AAAC,QAAG,QAAMF,IAAE;AAAC,OAAC,CAAC,KAAK,SAAS,aAAa,MAAI,EAAE,WAAW,EAAE,sBAAqBA,GAAE,MAAM,IAAE,KAAK,SAAS,WAAWA,EAAC;AAAA,IAAC;AAAA,EAAC;AAAA,EAAC,SAAQ;AAAC,SAAK,WAAW;AAAE,UAAMD,KAAE,KAAK,SAAS,aAAa;AAAI,IAAAA,KAAEA,GAAE,gBAAgB,IAAI,IAAE,KAAK,cAAc;AAAA,EAAC;AAAA,EAAC,gBAAe;AAAC,UAAK,EAAC,UAASA,IAAE,SAAQ,EAAC,IAAE;AAAK,IAAAA,MAAG,EAAE,MAAM,oCAAoC;AAAE,eAAUC,MAAKD,IAAE;AAAC,YAAM,IAAEA,GAAEC,EAAC;AAAE,WAAG,EAAE,MAAM,iCAAiC;AAAE,YAAMC,KAAE,EAAED,EAAC;AAAE,QAAE,KAAK,UAAS,KAAK,YAAW,GAAEC,EAAC;AAAA,IAAC;AAAC,YAAM,KAAK,gBAAc,KAAK,SAAS,aAAa,KAAK,aAAa,UAAU;AAAA,EAAC;AAAC;",
  "names": ["t", "i", "s", "r"]
}
